### @file etc/build/index.jsd ###
### @file_list lib/ ###
### @endfile ###

### @file etc/build/index.jst ###
{% include "build_template.tpl" %}
### @endfile ###


### @file ./package.json ###
{% include "package.tpl" %}
### @endfile ###


### @file lib/{{ data.namespace }}/{{ data.namespace }}.js ###


/**
 * @namespace
 */
var {{ data.namespace }} = {};


/**
 * @namespace
 */
{{ data.namespace }}.api = {};


/**
 * @namespace
 */
{{ data.namespace }}.client = {};


/**
 * @namespace
 */
{{ data.namespace }}.model = {};


/**
 * @type {string}
 */
{{ data.namespace }}.NAME = '{{ data.services[0].name | camel_to_kebab }}';


/**
 * @type {string}
 */
{{ data.namespace }}.VERSION = '{{ data.services[0].version }}';


/**
 * @return {!thrift.protocol.IProtocol}
 */
{{ data.namespace }}.protocol = function() {
  if ({{ data.namespace }}.__protocol === null) {
    {{ data.namespace }}.__protocol = new thrift.protocol.Json(new {{ data.namespace }}.Schema());
  }

  return {{ data.namespace }}.__protocol;
};


/**
 * @param {number} port
 * @param {string} host
 * @param {!tio.process.IWorker} worker
 */
{{ data.namespace }}.init = function(port, host, worker) {
  tio.process.init(
      new tio.process.Endpoint(port, host),
      new tio.process.Worker(worker));
};


/**
 *
 */
{{ data.namespace }}.reload = function() {
  tio.process.reload();
};


/**
 *
 */
{{ data.namespace }}.destroy = function() {
  tio.process.destroy();
};


/**
 * @type {thrift.protocol.IProtocol}
 */
{{ data.namespace }}.__protocol = null;


### @endfile ###


{% if data.services[0] %}

### @file lib/{{ data.namespace }}/schema.js ###
{% include "schema.tpl" %}
### @endfile ###

### @file lib/{{ data.namespace }}/client/client.js ###
{% include "client/client.tpl" %}
### @endfile ###

### @file lib/{{ data.namespace }}/api.js ###
{% include "api.tpl" %}
### @endfile ###

### @file lib/{{ data.namespace }}/api/i-handler.js ###
{% include "api/interface.tpl" %}
### @endfile ###

### @file lib/{{ data.namespace }}/api/handler.js ###
{% include "api/implementation.tpl" %}
### @endfile ###

### @file lib/{{ data.namespace }}/api/router.js ###
{% include "api/router.tpl" %}
### @endfile ###

{% endif %}


{% for structure in data.structures %}

### @file lib/{{ data.namespace }}/model/{{ structure.name | camel_to_kebab }}.js ###
{% include "model/struct.tpl" %}
### @endfile ###


### @file lib/{{ data.namespace }}/model/i-{{ structure.name | camel_to_kebab }}.js ###
{% include "model/i-struct.tpl" %}
### @endfile ###

{% endfor %}


{% for enum in data.enums %}

### @file lib/{{ data.namespace }}/model/{{ enum.name | camel_to_kebab }}.js ###
{% include "model/enum.tpl" %}
### @endfile ###

{% endfor %}


### @file lib/{{ data.namespace }}/model/i-builder.js ###
{% include "model/i-builder.tpl" %}
### @endfile ###


### @file lib/{{ data.namespace }}/model/builder.js ###
{% include "model/builder.tpl" %}
### @endfile ###


### @file lib/{{ data.namespace }}/model/model.js ###
{% include "model/model.tpl" %}
### @endfile ###
