{% set methods = data.services[0].methods %}


/**
 * @constructor
 * @implements {tio.listener.IRouter}
 * @param {!{{ data.namespace }}.api.IHandler=} opt_handler
 */
{{ data.namespace }}.api.Router = function(opt_handler) {

  /**
   * @type {!{{ data.namespace }}.api.IHandler}
   */
  this.__handler = opt_handler || new {{ data.namespace }}.api.Handler();
};


/**
 * @inheritDoc
 */
{{ data.namespace }}.api.Router.prototype.session =
    function(complete, cancel, call) {
  this.__handler.session(complete, cancel || yaa.cancel, call);
};


/**
 * @inheritDoc
 */
{{ data.namespace }}.api.Router.prototype.step = function(call) {
  var args = call.getArgs();
  var task = this.__handler.task(call);
  if (task !== null) {
    return task;
  }

  switch (call.getName()) {
    {% for method in methods -%}
    case {{ data.namespace }}.Api.{{ method.name | camel_to_snake(upper=true) }}:
      return this.__handler.{{ method.name }}(
          {%- for arg in method.arguments -%}
            {% if not loop.first %}, {% endif %}
            args[{{ arg.index - 1 }}]
          {%- endfor -%});

    {% endfor -%}
  }

  return yaa.error('Unknown call.');
};


/**
 * @inheritDoc
 */
{{ data.namespace }}.api.Router.prototype.stateful = function(call) {
  return this.__handler.stateful(call);
};
